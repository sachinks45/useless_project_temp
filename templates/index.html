<!DOCTYPE html>
<html lang="ml">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡¥Ö‡¥Æ‡µç‡¥Æ‡¥æ‡¥µ‡µª ‡¥â‡¥™‡¥¶‡µá‡¥∂ ‡¥ì‡¥§‡µÜ‡µª‡µç‡¥±‡¥ø‡¥ï‡µç‡¥ï‡µá‡¥±‡µç‡¥±‡µº</title>
  <link href="https://fonts.googleapis.com/css2?family=Manjari:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    /* Reset some basics */
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Manjari', sans-serif;
      margin: 0;
      padding: 30px 20px;
      background: linear-gradient(135deg, #FFF9E8, #DFF3E3);
      color: #34403f;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      transition: background-color 0.3s ease;
    }

    .container {
      background: #ffffffcc;
      max-width: 650px;
      width: 100%;
      padding: 40px 35px 50px;
      border-radius: 25px;
      box-shadow:
        0 6px 15px rgba(53, 81, 68, 0.1),
        0 10px 30px rgba(53, 81, 68, 0.15);
      text-align: center;
      backdrop-filter: saturate(180%) blur(10px);
      -webkit-backdrop-filter: saturate(180%) blur(10px);
    }

    h1 {
      font-weight: 800;
      font-size: 2.8rem;
      margin-bottom: 10px;
      color: #2b4c45;
      letter-spacing: 1px;
      text-shadow: 0 1px 2px #b7d9c1;
    }

    .subtitle {
      font-weight: 500;
      font-size: 1.25rem;
      color: #5e7b73;
      margin-bottom: 35px;
      line-height: 1.4;
      letter-spacing: 0.02em;
    }

    .input-group {
      text-align: left;
      margin-bottom: 30px;
    }

    .input-group label {
      font-weight: 700;
      font-size: 1.3rem;
      color: #2b4c45;
      margin-bottom: 12px;
      display: block;
      user-select: none;
    }
    .inputss{
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 20px;
    }

    #micBtn {
        width: 20%;
      margin-left: 8px;
      cursor: pointer;
      font-size: 1.5rem;
      background: none;
      border: none;
      color: #519872;
      transition: color 0.3s ease, transform 0.2s ease;
    }
    textarea {
      width: 80%;
      height: 100px;
      font-size: 1.1rem;
      padding: 18px 20px;
      border-radius: 16px;
      border: 2.5px solid #9fd8a8;
      resize: vertical;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      font-family: 'Manjari', sans-serif;
      line-height: 1.4;
      color: #34403f;
      box-shadow: inset 0 0 6px #cde8c5aa;
    }

    textarea::placeholder {
      color: #9fbc9e;
      font-style: italic;
    }

    textarea:focus {
      outline: none;
      border-color: #519872;
      box-shadow: 0 0 12px #76a970cc;
      background-color: #f4f9f2;
    }

    button {
      width: 100%;
      max-width: 320px;
      font-size: 1.3rem;
      padding: 18px 0;
      cursor: pointer;
      background-color: #519872;
      color: #fff;
      border: none;
      border-radius: 20px;
      font-family: 'Manjari', sans-serif;
      font-weight: 800;
      transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
      box-shadow: 0 6px 15px #a7d7abcc;
      user-select: none;
      margin: 0 auto;
      display: block;
      letter-spacing: 0.06em;
    }

    button:hover:not(:disabled) {
      background-color: #3f755e;
      transform: translateY(-3px);
      box-shadow: 0 9px 22px #7dc07ccc;
    }

    button:disabled {
      background-color: #b9d1b9;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }

    /* Loader */
    #loader {
      margin-top: 30px;
      display: none;
      justify-content: center;
      gap: 12px;
    }

    .dots div {
      width: 14px;
      height: 14px;
      background: #519872;
      border-radius: 50%;
      animation: bounce 1.4s infinite ease-in-out both;
    }

    .dot1 {
      animation-delay: -0.32s;
    }

    .dot2 {
      animation-delay: -0.16s;
    }

    @keyframes bounce {
      0%,
      80%,
      100% {
        transform: scale(0);
      }

      40% {
        transform: scale(1);
      }
    }

    /* Result box */
    #result {
      margin-top: 35px;
      background-color: #f0f6f1;
      border-radius: 18px;
      border-left: 6px solid #519872;
      padding: 25px 28px;
      text-align: left;
      color: #2b4c45;
      font-weight: 600;
      font-size: 1.15rem;
      line-height: 1.5;
      box-shadow: 0 4px 12px #a1cca988;
      display: none;
      position: relative;
    }

    #result h3 {
      margin-top: 0;
      font-weight: 700;
      font-size: 1.6rem;
      color: #3f7259;
      letter-spacing: 0.04em;
      user-select: none;
    }

    #result p {
      margin: 12px 0;
      word-wrap: break-word;
    }

    #result strong {
      color: #43794f;
    }

    #result button {
      margin-top: 18px;
      font-size: 1.1rem;
      width: 140px;
      padding: 10px 0;
      border-radius: 14px;
      box-shadow: none;
      background-color: #43794f;
      transition: background-color 0.3s ease;
      display: block;
    }

    #result button:hover {
      background-color: #315d39;
      cursor: pointer;
    }

    /* Footer */
    .footer {
      margin-top: 45px;
      font-size: 0.85rem;
      color: #7b8a7b;
      text-align: center;
      user-select: none;
      letter-spacing: 0.04em;
    }

    /* Responsive */
    @media (max-width: 400px) {
      .container {
        padding: 25px 20px 40px;
      }

      h1 {
        font-size: 2.1rem;
      }

      .subtitle {
        font-size: 1rem;
      }

      textarea {
        height: 20px;
      }

      button {
        max-width: 100%;
      }
    }
    #micBtn.listening {
  color: #e63946;
  animation: pulse 1.2s infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.3); }
}

  </style>
</head>

<body>
  <div class="container">
    <h1>‡¥Ö‡¥Æ‡µç‡¥Æ‡¥æ‡¥µ‡µª ‡¥â‡¥™‡¥¶‡µá‡¥∂ ‡¥ì‡¥§‡µÜ‡µª‡µç‡¥±‡¥ø‡¥ï‡µç‡¥ï‡µá‡¥±‡µç‡¥±‡µº üß†üë¥</h1>
    <p class="subtitle">‡¥ú‡µÄ‡¥µ‡¥ø‡¥§‡¥Ç ‡¥Æ‡¥æ‡¥±‡µç‡¥±‡¥ø‡¥Æ‡¥±‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥® ‡¥â‡¥™‡¥¶‡µá‡¥∂‡¥Æ‡µã, ‡¥Ö‡¥§‡µã ‡¥µ‡µÜ‡¥±‡µÅ‡¥Ç ‡¥™‡¥¥‡¥Ø‡¥ï‡¥æ‡¥≤ ‡¥§‡¥≥‡µç‡¥≥‡¥≤‡µã? ‡¥û‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ AI ‡¥§‡µÄ‡¥∞‡µÅ‡¥Æ‡¥æ‡¥®‡¥ø‡¥ï‡µç‡¥ï‡¥ü‡µç‡¥ü‡µÜ!</p>

    <div class="input-group">
      <label for="adviceInput">üë¥ ‡¥Ö‡¥Æ‡µç‡¥Æ‡¥æ‡¥µ‡µª ‡¥™‡¥±‡¥û‡µç‡¥û‡µÅ:</label>
      <div class="inputss">
      <textarea id="adviceInput" placeholder="‡¥≤‡¥≠‡¥ø‡¥ö‡µç‡¥ö ‡¥â‡¥™‡¥¶‡µá‡¥∂‡¥Ç ‡¥á‡¥µ‡¥ø‡¥ü‡µÜ ‡¥ü‡µà‡¥™‡µç‡¥™‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï..."></textarea>
      <button id="micBtn" title="Speak" style="margin-left: 8px; cursor: pointer; font-size: 1.5rem; background: none; border: none; color: #519872;">
      üé§
    </button>
</div>
    </div>

    <button id="analyzeBtn" onclick="getAnalysis()">‡¥µ‡¥ø‡¥∂‡¥ï‡¥≤‡¥®‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï ‚ú®</button>

    <div id="loader">
      <div class="dots">
        <div class="dot1"></div>
        <div class="dot2"></div>
        <div class="dot3"></div>
      </div>
    </div>

    <div id="result"></div>

    <div class="footer">
      Made with pazham pori & sarcasm in Kerala üçå‚ù§Ô∏è
    </div>
  </div>

  <script>
    const adviceInput = document.getElementById('adviceInput');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const resultDiv = document.getElementById('result');
    const loader = document.getElementById('loader');

    async function getAnalysis() {
      const adviceText = adviceInput.value;
      if (!adviceText.trim()) {
        alert('‡¥µ‡¥ø‡¥∂‡¥ï‡¥≤‡¥®‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥æ‡µª ‡¥â‡¥™‡¥¶‡µá‡¥∂‡¥Ç ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï!');
        return;
      }

      // Disable button and show loader
      analyzeBtn.disabled = true;
      analyzeBtn.innerText = "‡¥Ö‡¥®‡¥≤‡µà‡¥∏‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥®‡µç‡¥®‡µÅ...";
      resultDiv.style.display = 'none';
      loader.style.display = 'flex';

      try {
        const response = await fetch('https://ammavan.onrender.com/analyze', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ advice_text: adviceText })
        });

        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

        const data = await response.json();

        loader.style.display = 'none';
        resultDiv.style.display = 'block';

        resultDiv.innerHTML = `
                    <h3>‡¥µ‡¥ø‡¥∂‡¥ï‡¥≤‡¥®‡¥Ç ‡¥™‡µÇ‡µº‡¥§‡µç‡¥§‡¥ø‡¥Ø‡¥æ‡¥Ø‡¥ø:</h3>
                    <p><strong>‡¥§‡¥∞‡¥Ç:</strong> ${data.classification}</p>
                    <p><strong>‡¥ï‡µÉ‡¥§‡µç‡¥Ø‡¥§:</strong> ${data.confidence}</p>
                    <p><strong>‡¥∂‡µÅ‡¥™‡¥æ‡µº‡¥∂ ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥®‡µç‡¥® ‡¥™‡µç‡¥∞‡¥§‡¥ø‡¥ï‡¥∞‡¥£‡¥Ç:</strong> ${data.recommended_action}</p>
                    <br>
                    <button onclick="resetApp()">‡¥µ‡µá‡¥±‡µä‡¥∞‡µÜ‡¥£‡µç‡¥£‡¥Ç ‡¥∂‡µç‡¥∞‡¥Æ‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥Ç</button>
                `;
      } catch (error) {
        loader.style.display = 'none';
        alert('‡¥í‡¥∞‡µÅ ‡¥™‡¥ø‡¥∂‡¥ï‡µç ‡¥∏‡¥Ç‡¥≠‡¥µ‡¥ø‡¥ö‡µç‡¥ö‡µÅ. ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ Python ‡¥¨‡¥æ‡¥ï‡µç‡¥ï‡µÜ‡µª‡¥°‡µç ‡¥™‡µç‡¥∞‡¥µ‡µº‡¥§‡µç‡¥§‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ‡¥£‡µç‡¥ü‡µã ‡¥é‡¥®‡µç‡¥®‡µç ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï.');
        console.error('Error:', error);
        resetApp();
      }
    }

    function resetApp() {
      adviceInput.value = '';
      resultDiv.style.display = 'none';
      analyzeBtn.disabled = false;
      analyzeBtn.innerText = "‡¥µ‡¥ø‡¥∂‡¥ï‡¥≤‡¥®‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï ‚ú®";
    }
    const micBtn = document.getElementById('micBtn');

if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
  micBtn.style.display = 'none'; // Hide mic button if speech not supported
} else {
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  const recognition = new SpeechRecognition();

  recognition.lang = 'ml-IN';  // Malayalam (India) locale for better accuracy
  recognition.interimResults = false;
  recognition.maxAlternatives = 1;

  micBtn.addEventListener('click', () => {
    if (micBtn.classList.contains('listening')) {
      recognition.stop();
      return;
    }
    recognition.start();
  });

  recognition.onstart = () => {
    micBtn.classList.add('listening');
    micBtn.style.color = '#e63946'; // red color when recording
  };

  recognition.onend = () => {
    micBtn.classList.remove('listening');
    micBtn.style.color = '#519872'; // back to normal color
  };

  recognition.onerror = (event) => {
    alert('‡¥∂‡¥¨‡µç‡¥¶‡¥Ç ‡¥™‡¥ø‡¥ü‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥®‡µç‚Äç ‡¥™‡¥±‡µç‡¥±‡¥ø‡¥Ø‡¥ø‡¥≤‡µç‡¥≤. ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥∂‡µç‡¥∞‡¥Æ‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï.');
    micBtn.classList.remove('listening');
    micBtn.style.color = '#519872';
  };

  recognition.onresult = (event) => {
    const transcript = event.results[0][0].transcript;
    adviceInput.value += (adviceInput.value ? ' ' : '') + transcript;
  };
}

  </script>
</body>

</html>
